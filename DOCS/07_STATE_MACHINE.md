# 07_STATE_MACHINE — FSM

## FSM (целевой контур для v0.8.0)
```
IDLE → ARMED → POSITION_OPEN → EXIT → COOLDOWN → IDLE
```

### Описание состояний
- **IDLE** — бот подключён, но не готов торговать.
- **ARMED** — все проверки пройдены, разрешён вход.
- **POSITION_OPEN** — позиция открыта, ордера и риски контролируются.
- **EXIT** — активная попытка выхода (SELL размещён/исполняется).
- **COOLDOWN** — временная блокировка после цикла/ошибки.

## Запрещённые переходы
- IDLE → POSITION_OPEN (нельзя без ARMED).
- ARMED → EXIT (нельзя без открытой позиции).
- POSITION_OPEN → ARMED (обратный переход запрещён, только EXIT/COOLDOWN).
- EXIT → ARMED (только через COOLDOWN).

## Текущая FSM (реализовано в TradeExecutor)
```
IDLE → PLACE_BUY → WAIT_BUY → POSITION_OPEN → PLACE_SELL → WAIT_SELL → CLOSED → IDLE
```
- Имеется состояние ERROR, но нет строгого COOLDOWN.
- Нет единого «gate» ARMED (разрешения входа) на уровне FSM.

## Почему FSM критичен для v0.8.0
- Убирает хаотичные переходы при сбоях данных или ордеров.
- Позволяет централизованно блокировать входы при data_blind, borrow fail и других ошибках.
- Делает поведение воспроизводимым, что критично для дальнейшей механики и тестирования.
