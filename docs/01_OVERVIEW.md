# Overview

## Назначение проекта
Directional Hedge Scalper — GUI-клиент для ручного тестового цикла **BUY → SELL** на Binance в режиме Cross Margin. Он не принимает решения, а обеспечивает строгий, воспроизводимый и безопасный цикл исполнения с наблюдаемой телеметрией и понятными ограничениями.

## Ключевые свойства
- **Детерминированный цикл**: один вход и один выход, без параллельных сделок и повторных авто-проходов.
- **Прозрачная телеметрия**: логируются причины блокировок, статусы, цены, PnL и причина выхода.
- **Фокус на технике исполнения**: точные правила цены, ограничений биржи и контроль свежести котировок.

## Базовый торговый цикл
1. **CONNECT**: GUI подключает Market Data и проверяет здоровье источников.
2. **START → BUY**: `TradeExecutor.place_test_orders_margin()` валидирует цены/лимиты и выставляет лимитный BUY.
3. **WAIT_BUY**: ожидание заполнения BUY и формирование позиции.
4. **POSITION_OPEN**: отслеживание TP/SL по `mid` и ручной STOP.
5. **SELL**: выставление лимитного SELL (или emergency market при крайних условиях частичного закрытия).
6. **CLOSED**: расчёт PnL и завершение цикла.

## Что делает бот
- Подключает Market Data и показывает котировки/статусы.
- Позволяет вручную инициировать BUY и вручную закрыть позицию SELL.
- Автоматически закрывает позицию по тикам при достижении TP/SL (одно правило на каждое направление).
- Отображает состояние ордеров, позиции, PnL и последнюю причину выхода.

## Чего НЕ делает бот
- Не принимает торговые решения и не запускает стратегию.
- Не запускает автоматический цикл сам по себе (кроме конфигурируемых повторов в рамках ручного запуска).
- Не выполняет параллельные торговые действия.
- Не учитывает комиссии, funding и проценты по займу в PnL.

## Торговый инструмент и режим
- Инструмент: **EURIUSDT**.
- Режим: **Cross Margin x3**.

## Текущий статус
- **v0.7.2**: симметричный авто-выход по тикам (TP/SL), единый LIMIT/MARKET выход.

## v0.7.14 changes
- SL выставляется как crossing-лимит по **bid** (чтобы закрытие было быстрым).
- Добавлена анти-флап гистерезисная фиксация источника WS/HTTP.
- Репрайс выхода выполняется только при движении референс-цены минимум на 1 тик.
