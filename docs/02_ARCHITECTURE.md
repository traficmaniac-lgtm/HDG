# Architecture

## Общая архитектура модулей
- **MarketData**: поток котировок из WS/HTTP, метрики свежести, выбор источника.
- **TradeEngine**: жизненный цикл ордеров BUY/SELL, позиция, базовый PnL и авто-выход по TP/SL.
- **Margin**: настройки режима, sideEffectType, проверки доступности borrow.
- **GUI**: пользовательское управление (CONNECT/START/STOP) и отображение состояния.

## Границы ответственности модулей
- **MarketData** отвечает только за получение/валидацию котировок и возраст данных.
- **TradeEngine** отвечает за торговые действия, локальные статусы ордеров/позиции и детерминированный TP/SL в POSITION_OPEN.
- **Margin** отвечает за правила работы с Cross Margin и sideEffectType.
- **GUI** инициирует действия и отображает данные, но не принимает решений.

## Core vs вспомогательное
- **Core**: MarketData, TradeEngine, Margin — это источник истины для логики и статусов.
- **Вспомогательное**: GUI, внешние API (Binance WS/HTTP/SAPI), конфиг/логирование.
