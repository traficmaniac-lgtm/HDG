# PnL Model

## Unrealized / Realized
- **Unrealized**: `(mid - buy_price) * qty`.
  - Если позиция ещё не открыта, используется BUY-ордер (status NEW).
- **Realized (cycle)**: `(sell_price - buy_price) * qty` при закрытии позиции.

## Текущая формула (простая)
- Без комиссий, проскальзывания, частичных исполнений и funding.
- `pnl_cycle` — результат последнего закрытого цикла.
- `pnl_session` — сумма `pnl_cycle` за сессию.

## Что планируется улучшить
- Учет комиссий и проскальзывания.
- Поддержка частичных исполнений и среднего входа.
- Единый расчёт PnL для BUY/SELL на разных режимах.
